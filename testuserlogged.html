<!DOCTYPE html>
<html>
<head>
    <title>Google Sign-In with Firebase</title>
    <script src="https://www.gstatic.com/firebasejs/9.9.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.9.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.9.1/firebase-firestore-compat.js"></script>
     <script src="https://accounts.google.com/gsi/client" async defer></script>
</head>
<body>
    <button id="googleSignInBtn">Sign in with Google</button>
    <button id="googleSignOutBtn">Sign out</button>
    
    <script>
        // Your web app's Firebase configuration
        const firebaseConfig = {
          apiKey: "AIzaSyBU0ns9VzWBxbHOIgTR-Yb6g1aFbOQEWFA",
        authDomain: "engineerr1983meet.firebaseapp.com",
        projectId: "engineerr1983meet",
        storageBucket: "engineerr1983meet.appspot.com",
        messagingSenderId: "308801516934",
        appId: "1:308801516934:web:1a3833be5e03dfbcd66807",
        measurementId: "G-X22VZ2TVWT"
        };

        // Initialize Firebase
        const app = firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        let loggedInEmail = '';

        // Function to handle Google Sign-In
        function signInWithGoogle() {
            const provider = new firebase.auth.GoogleAuthProvider();
            auth.signInWithPopup(provider)
                .then(result => {
                    const user = result.user;
                    loggedInEmail = user.email;
                    console.log('Logged in as:', loggedInEmail);
                    // Proceed with allowing user to access the application
                })
                .catch(error => {
                    console.error('Error signing in:', error);
                    alert('Error signing in: ' + error.message);
                });
        }

         // Function to handle Google Sign-Out
        function signOut() {
            auth.signOut().then(() => {
                console.log('User signed out.');
                loggedInEmail = '';
                if (window.google && google.accounts && google.accounts.id) {
                    google.accounts.id.disableAutoSelect();
                    console.log('it worked');
                } else {
                    console.warn('Google accounts library is not loaded.');
                }
                // Handle any post-sign-out logic here
            }).catch(error => {
                console.error('Error signing out:', error);
                alert('Error signing out: ' + error.message);
            });
        }


        // Function to check authentication state and get the logged-in user's email
        auth.onAuthStateChanged(user => {
            if (user) {
                loggedInEmail = user.email;
                console.log('Auth state changed. Logged in as:', loggedInEmail);
                // Proceed with allowing user to access the application
            } else {
                console.log('No user is logged in.');
            }
        });

        // Attach the sign-in function to the button
        document.getElementById('googleSignInBtn').addEventListener('click', signInWithGoogle);
        document.getElementById('googleSignOutBtn').addEventListener('click', signOut);
    </script>
</body>
</html>
