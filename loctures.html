<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lectures' Videos</title>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-firestore-compat.js"></script>
     <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
    <!-- Firebase initialization script -->
    <script src="loadattendeailfromfirestore.js"></script>
</head>
<body>
    <h3>Lectures' Videos</h3>
    <table id="lectures-table" border="1" cellpadding="10" cellspacing="0">
        <thead>
            <tr>
                <th>Lecturer</th>
                <th>Last Updated</th>
                <th>Display the Lecture</th>
            </tr>
        </thead>
        <tbody>
            <!-- Rows will be added here dynamically -->
        </tbody>
    </table>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const db = firebase.firestore();
            const lecturesTableBody = document.querySelector('#lectures-table tbody');

            function loadLectures() {
                db.collection('meetings_his_tbl').get()
                    .then(querySnapshot => {
                        querySnapshot.forEach(doc => {
                            const lecture = doc.data();
                            const row = document.createElement('tr');

                            const lecturerCell = document.createElement('td');
                            lecturerCell.textContent = lecture.creatorEmail;

                            const updatedCell = document.createElement('td');
                            updatedCell.textContent = new Date(lecture.stopRecordingTime.seconds * 1000).toLocaleString();

                            const linkCell = document.createElement('td');
                            const link = document.createElement('a');
                            link.href = "#";
                            link.textContent = "Display the lecture";
                            link.classList.add('video-link');
                            link.setAttribute('data-url', lecture.videoURL);
                            linkCell.appendChild(link);

                            row.appendChild(lecturerCell);
                            row.appendChild(updatedCell);
                            row.appendChild(linkCell);

                            row.addEventListener('click', function() {
                                const selected = lecturesTableBody.querySelector('.selected');
                                if (selected) {
                                    selected.classList.remove('selected');
                                    selected.style.boxShadow = '';
                                }
                                row.classList.add('selected');
                                row.style.boxShadow = '0 0 10px blue';
                            });

                            lecturesTableBody.appendChild(row);
                        });
                    })
                    .catch(error => console.error("Error loading lectures:", error));
            }

            loadLectures();
        });
    </script>
</body>
</html>
